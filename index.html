<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Data pertanyaan dan jawaban
        const questions = [
            {
                question: "Siapa yang sering disebut sebagai 'Bapak Ekonomi Modern'?",
                options: ["Karl Marx", "John Maynard Keynes", "Adam Smith", "Milton Friedman"],
                correctAnswer: 2
            },
            {
                question: "Sistem ekonomi apa yang dominan di Eropa pada abad 16-18 yang menekankan pada akumulasi logam mulia?",
                options: ["Feodalisme", "Merkantilisme", "Kapitalisme", "Sosialisme"],
                correctAnswer: 1
            },
            {
                question: "Peristiwa ekonomi besar apa yang terjadi pada tahun 1929 yang mempengaruhi ekonomi global?",
                options: ["Revolusi Industri", "Great Depression", "Krisis Minyak 1973", "Resesi 2008"],
                correctAnswer: 1
            },
            {
                question: "Apa nama sistem tanam paksa yang diterapkan Belanda di Indonesia pada abad 19?",
                options: ["Cultuurstelsel", "Landrent", "Pax Neerlandica", "Hindia Belanda"],
                correctAnswer: 0
            },
            {
                question: "Teori ekonomi siapa yang menjadi dasar New Deal di Amerika Serikat tahun 1930-an?",
                options: ["Adam Smith", "John Maynard Keynes", "David Ricardo", "Friedrich Hayek"],
                correctAnswer: 1
            },
            {
                question: "Apa nama program ekonomi Indonesia pada masa Orde Baru yang fokus pada pembangunan?",
                options: ["Repelita", "Benteng", "Gunting Syafruddin", "Gerakan Benteng"],
                correctAnswer: 0
            },
            {
                question: "Krisis ekonomi tahun 1997 di Asia dimulai di negara mana?",
                options: ["Indonesia", "Thailand", "Korea Selatan", "Malaysia"],
                correctAnswer: 1
            },
            {
                question: "Apa nama tokoh ekonomi Indonesia yang dikenal sebagai arsitek ekonomi Orde Baru?",
                options: ["Mohammad Hatta", "Sumitro Djojohadikusumo", "Widjojo Nitisastro", "Sjafruddin Prawiranegara"],
                correctAnswer: 2
            },
            {
                question: "Revolusi Industri pertama dimulai di negara mana?",
                options: ["Amerika Serikat", "Jerman", "Inggris", "Prancis"],
                correctAnswer: 2
            },
            {
                question: "Apa nama kebijakan ekonomi Indonesia tahun 1950-an yang membatasi impor untuk melindungi industri dalam negeri?",
                options: ["Sistem Ekonomi Terpimpin", "Gerakan Benteng", "Nasionalisasi", "Demokrasi Ekonomi"],
                correctAnswer: 1
            }
        ];

        // Variabel state kuis
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedOption = null;
        let quizCompleted = false;

        // Elemen DOM
        const questionElement = document.getElementById('question');
        const optionsElement = document.getElementById('options');
        const nextButton = document.getElementById('next-btn');
        const resultContainer = document.getElementById('result-container');
        const questionContainer = document.getElementById('question-container');
        const scoreElement = document.getElementById('score');
        const scoreTextElement = document.getElementById('score-text');
        const feedbackElement = document.getElementById('feedback');
        const restartButton = document.getElementById('restart-btn');
        const questionCounter = document.getElementById('question-counter');
        const progressBar = document.getElementById('progress-bar');

        // Fungsi untuk menampilkan pertanyaan
        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const question = questions[currentQuestionIndex];
            questionElement.textContent = question.question;
            optionsElement.innerHTML = '';
            selectedOption = null;

            // Update counter
            questionCounter.textContent = Pertanyaan ${currentQuestionIndex + 1} dari ${questions.length};
            
            // Update progress bar
            progressBar.style.width = ${((currentQuestionIndex) / questions.length) * 100}%;

            // Buat opsi jawaban
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectOption(optionElement, index));
                optionsElement.appendChild(optionElement);
            });

            // Sembunyikan tombol next jika belum memilih jawaban
            nextButton.style.display = 'none';
            nextButton.disabled = true;
        }

        // Fungsi untuk memilih opsi
        function selectOption(optionElement, optionIndex) {
            if (quizCompleted) return;

            // Hapus seleksi sebelumnya
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));

            // Tandai opsi yang dipilih
            optionElement.classList.add('selected');
            selectedOption = optionIndex;

            // Tampilkan tombol next
            nextButton.style.display = 'inline-block';
            nextButton.disabled = false;
        }

        // Fungsi untuk mengecek jawaban
        function checkAnswer() {
            if (selectedOption === null) return;

            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.option');

            // Tandai jawaban yang benar dan salah
            options.forEach((option, index) => {
                option.classList.remove('correct', 'incorrect');
                if (index === question.correctAnswer) {
                    option.classList.add('correct');
                } else if (index === selectedOption && selectedOption !== question.correctAnswer) {
                    option.classList.add('incorrect');
                }
            });

            // Hitung skor jika jawaban benar
            if (selectedOption === question.correctAnswer) {
                score++;
            }

            // Nonaktifkan semua opsi
            options.forEach(option => {
                option.style.pointerEvents = 'none';
            });

            // Update tombol next
            if (currentQuestionIndex === questions.length - 1) {
                nextButton.textContent = 'Lihat Hasil';
            } else {
                nextButton.textContent = 'Selanjutnya';
            }
        }

        // Fungsi untuk menampilkan hasil
        function showResult() {
            questionContainer.style.display = 'none';
            resultContainer.style.display = 'block';
            document.querySelector('.quiz-footer').style.display = 'none';
            progressBar.style.width = '100%';
            quizCompleted = true;

            // Hitung persentase
            const percentage = (score / questions.length) * 100;
            scoreElement.textContent = ${score}/${questions.length};

            // Berikan feedback berdasarkan skor
            if (percentage >= 80) {
                scoreTextElement.textContent = "Luar biasa! Anda sangat menguasai materi sejarah ekonomi.";
                feedbackElement.innerHTML = "<p>Pengetahuan Anda tentang perkembangan ekonomi sangat baik. Pertahankan!</p>";
            } else if (percentage >= 60) {
                scoreTextElement.textContent = "Bagus! Anda memiliki pemahaman yang cukup tentang sejarah ekonomi.";
                feedbackElement.innerHTML = "<p>Anda sudah memahami banyak konsep dasar, tetapi masih ada ruang untuk meningkatkan pengetahuan Anda.</p>";
            } else if (percentage >= 40) {
                scoreTextElement.textContent = "Cukup baik. Anda memiliki beberapa pengetahuan tentang sejarah ekonomi.";
                feedbackElement.innerHTML = "<p>Anda mungkin perlu mempelajari kembali beberapa bagian materi untuk memperdalam pemahaman.</p>";
            } else {
                scoreTextElement.textContent = "Anda mungkin perlu belajar lebih banyak tentang sejarah ekonomi.";
                feedbackElement.innerHTML = "<p>Jangan khawatir! Pelajari kembali materi dan coba lagi nanti.</p>";
            }

            // Animasi skor
            animateValue(scoreElement, 0, score, 1000);
        }

        // Fungsi animasi angka
        function animateValue(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const currentValue = Math.floor(progress * (end - start) + start);
                element.textContent = ${currentValue}/${questions.length};
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // Fungsi reset kuis
        function resetQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            selectedOption = null;
            quizCompleted = false;
            
            questionContainer.style.display = 'block';
            resultContainer.style.display = 'none';
            document.querySelector('.quiz-footer').style.display = 'flex';
            
            nextButton.textContent = 'Selanjutnya';
            nextButton.style.display = 'none';
            nextButton.disabled = true;
            
            showQuestion();
        }

        // Event listeners
        nextButton.addEventListener('click', () => {
            if (selectedOption === null && currentQuestionIndex < questions.length) return;
            
            // Periksa jawaban terlebih dahulu
            checkAnswer();
            
            // Tunggu sebentar sebelum pindah ke pertanyaan berikutnya
            setTimeout(() => {
                currentQuestionIndex++;
                showQuestion();
            }, 1000);
        });

        restartButton.addEventListener('click', resetQuiz);

        // Mulai kuis
        showQuestion();

        // Animasi scroll halus untuk link navigasi
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    });
</script>
